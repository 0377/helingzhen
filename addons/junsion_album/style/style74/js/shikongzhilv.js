function shikongzhilv_SCENE_EXTEND(t,e){t.prototype=new e,t.prototype.constructor=t}function shikongzhilvSceneBase(){this.effect_in=["zoomIn animateShow","zoomInDown animateShow","zoomInUp animateShow","zoomInLeft animateShow","zoomInRight animateShow"],this.effect_out=[],this.imgWidth=0,this.imgHeight=0,this.show_speed=3,this.hide_speed=3.5,this.curImgItems=[null,null,null,null],this.points=[]}function shikongzhilvScene1(t,e,i,s,n){this.params(t,e,i,s,n),this.imgWidth=parseInt(.5*Math.min(this.canvasWidth,this.canvasHeight)),this.imgHeight=this.imgWidth,this.show_speed=3,this.hide_speed=3.5,this.effect_out=[["bounceOutLeft animateHide"],["bounceOutRight animateHide"]],this.curImgItems=[null],this.points.push([parseInt((this.canvasWidth-this.imgWidth)/2),parseInt((this.canvasHeight-this.imgHeight)/2)])}function shikongzhilvScene2(t,e,i,s,n){this.params(t,e,i,s,n),this.imgWidth=parseInt(.45*Math.min(this.canvasWidth,this.canvasHeight)),this.imgHeight=this.imgWidth,this.show_speed=3,this.hide_speed=2.5,this.effect_out=[["bounceOutUp animateHide","bounceOutDown animateHide"],["bounceOutDown animateHide","bounceOutUp animateHide"],["bounceOutRight animateHide","bounceOutLeft animateHide"]],this.curImgItems=[null,null];var a=(this.canvasHeight-1.7*this.imgHeight)/2,h=(this.canvasWidth-1.7*this.imgWidth)/2;this.points=[[h,a],[parseInt(h+.7*this.imgWidth),parseInt(a+.7*this.imgHeight)]]}function shikongzhilvScene3(t,e,i,s,n){this.params(t,e,i,s,n),this.imgWidth=parseInt(.35*Math.min(this.canvasWidth,this.canvasHeight)),this.imgHeight=this.imgWidth,this.show_speed=2.5,this.hide_speed=2.5,this.effect_out=[["bounceOutDown animateHide","bounceOutUp animateHide","bounceOutRight animateHide","bounceOutLeft animateHide"]],this.curImgItems=[null,null,null,null];var a=.15,h=(this.canvasHeight-this.imgHeight*(3-2*a))/2,c=(this.canvasWidth-this.imgWidth)/2,o=(this.canvasHeight-this.imgHeight)/2,m=(this.canvasWidth-(3-2*a)*this.imgWidth)/2;this.points=[[c,h],[c,parseInt(h+this.imgHeight*(2-2*a))],[m,o],[parseInt(m+this.imgWidth*(2-2*a)),o]]}function shikongzhilvScene4(t,e,i,s,n){this.params(t,e,i,s,n),this.imgWidth=parseInt(.3*Math.min(this.canvasWidth,this.canvasHeight)),this.imgHeight=this.imgWidth,this.show_speed=3,this.hide_speed=2.5,this.effect_out=[["bounceOutDown animateHide","bounceOutLeft animateHide","bounceOutUp animateHide","bounceOutRight animateHide","rotateOut animateHide"]],this.curImgItems=[null,null,null,null,null];var a=.1,h=parseInt((this.canvasHeight-this.imgHeight*(3-2*a))/2),c=parseInt((this.canvasWidth-(3-2*a)*this.imgWidth)/2);this.points=[[c,h],[parseInt(c+this.imgWidth*(2-2*a)),h],[parseInt(c+this.imgWidth*(2-2*a)),parseInt(h+this.imgWidth*(2-2*a))],[c,parseInt(h+this.imgWidth*(2-2*a))],[parseInt(c+this.imgWidth*(1-a)),parseInt(h+this.imgHeight*(1-a))]]}function shikongzhilvScene5(t,e,i,s,n){this.params(t,e,i,s,n),this.imgWidth=parseInt(.2*Math.min(this.canvasWidth,this.canvasHeight)),this.imgHeight=this.imgWidth,this.show_speed=3,this.hide_speed=3.5,this.effect_out=[["zoomOutDown animateHide","zoomOutLeft animateHide","zoomOutLeft animateHide","zoomOutUp animateHide","zoomOutRight animateHide","zoomOutRight animateHide","zoomOut animateHide"]],this.curImgItems=[null,null,null,null,null,null,null];for(var a=Math.min(this.canvasWidth,this.canvasHeight),h=(a-this.imgWidth)/2,c=this.canvasWidth/2,o=this.canvasHeight/2,m=0;6>m;++m){var p=60*m,l=parseInt(c+h*Math.cos((90-p)*Math.PI/180)-this.imgWidth/2),g=parseInt(o-h*Math.sin((90-p)*Math.PI/180)-this.imgHeight/2);this.points.push([l,g])}this.points.push([parseInt(c-this.imgWidth/2),parseInt(o-this.imgHeight/2)])}function EVA_ALBUM_shikongzhilv(t){function e(){var t=["bkgnd6.jpg","bkgnd7.jpg","bkgnd8.jpg","bkgnd9.jpg","bkgnd10.jpg","bkgnd12.jpg","bkgnd13.jpg"],e=null,i=null;hasClass(H,"bkgnd_show")?(e=H,i=y):(e=y,i=H);var s=parseInt(Math.random()*t.length);o(i,_,w,APP_URL+""+t[s]),i.className="bkgnd_show",e.className="bkgnd_hide"}function i(){I=!0,1!=g&&(g=!0,s())}function s(){console.log("__initElements");var e=new shikongzhilvScene1(_,w,a,m,n),i=new shikongzhilvScene2(_,w,a,m,n),s=new shikongzhilvScene3(_,w,a,m,n),h=new shikongzhilvScene4(_,w,a,m,n),c=new shikongzhilvScene5(_,w,a,m,n);r.push(e),r.push(i),r.push(s),r.push(h),r.push(c);for(var o=0;16>o;++o){var l=parseInt(Math.random()*_),g=parseInt(400*Math.random()),d=document.createElement("div");d.className="star",d.style.left=l+"px",d.style.top=g+"px",d.style["-webkit-animation-duration"]=5*Math.random()+1+"s",E.appendChild(d)}var u=t.images.length,I=Math.max(u,14);for(o=0;I>o;++o){var S=t.images[o%u],v=document.createElement("div");v.innerHTML='<div class="shikongzhilv_img_wrapper"><img></div>',v.style.position="absolute",v.style.zIndex=2,v.style.display="none",v.style.overflow="hidden",v.style.background="#FFF",v.style.boxShadow=v.style.webkitBoxShadow="0 0 10px 4px #9cf",v.onclick=p;var H=v.getElementsByTagName("img")[0];H.src=S.src,b.appendChild(v),f.push(v)}}function n(){null!=W&&(console.log("	Leave scene #"+x),W.leave(),W=null);var t=++d;d>=r.length&&(t=parseInt(Math.random()*r.length),t==x&&(t=(x+1)%r.length)),d%3==0&&e(),x=t,W=r[t],console.log("Play scene #"+t),W.enter()}function a(){return u++,u>=f.length&&(u=0),f[u]}function h(t){for(var e in g_images)if(g_images[e].src==t)return g_images[e];return null}function c(t,e,i){var s=h(t.src);void 0==s&&(s=t);var n=calcImgClip(e,i,s.width,s.height);t.style.left=0-n.clipLeft+"px",t.style.top=0-n.clipTop+"px",t.style.width=n.objWidth+"px",t.style.height=n.objHeight+"px",t.style.clip="rect("+n.clipTop+"px "+Math.floor(n.clipLeft+e)+"px "+Math.floor(n.clipTop+i)+"px "+n.clipLeft+"px)"}function o(t,e,i,s){t.src=s,c(t,e,i),t.onload=function(){c(t,e,i)}}function m(t,e,i){var s=t.getElementsByTagName("img")[0];o(s,e,i,s.src)}function p(){var t=this.getElementsByTagName("img")[0];g_albumPlayer.previewImage(t.src)}var l,g=!1,d=0,u=0,r=[],I=!1,f=[],S=$node(t.canvas_id),v=document.createElement("div"),_=t.max_width,w=t.max_height;v.id="EVA_ALBUM_shikongzhilv",v.style.display="none",v.style.width=_+"px",v.style.height=w+"px",S.appendChild(v);var H=document.createElement("img");H.style.position="absolute",H.style.zIndex=0,v.appendChild(H);var y=document.createElement("img");y.style.position="absolute",y.style.zIndex=0,v.appendChild(y);var E=document.createElement("div");E.id="shikongzhilv_wrapper",E.style.width=_+"px",E.style.height=w+"px",E.style.zIndex=1,v.appendChild(E);var b=document.createElement("div");b.id="shikongzhilv_imgItems_wrapper",b.style.width=_+"px",b.style.height=w+"px",v.appendChild(b),loadCSSFile(APP_URL+"main.css?t=201503011607",i,i,"EVA_ALBUM_shikongzhilv_Check_Loaded"),this.play=function(){if(this.stop(),v.style.display="block",1==I)n();else var t=window.setInterval(function(){1==I&&(log("trace","real begin to play"),window.clearInterval(t),n())},100)},this.stop=function(){null!=l&&(window.clearInterval(l),l=null),u=-1,d=-1},this.setBkgnd=function(){};var W=null,x=-1}shikongzhilvSceneBase.prototype.params=function(t,e,i,s,n){this.canvasWidth=t,this.canvasHeight=e,this.fnGetNextImg=i,this.fnAdjustImgItem=s,this.fnPlayEnd=n},shikongzhilvSceneBase.prototype.onShowEnd=function(){this.leave(),this.fnPlayEnd()},shikongzhilvSceneBase.prototype.enter=function(){function t(){n.onShowEnd(),$unlisten(this,"webkitAnimationEnd",t)}for(var e=0;e<this.curImgItems.length;++e){var i=this.points[e][0],s=this.points[e][1];if(this.curImgItems[e]=this.fnGetNextImg(),0==e){var n=this;$listen(this.curImgItems[0],"webkitAnimationEnd",t)}this.curImgItems[e].style.top=s+"px",this.curImgItems[e].style.left=i+"px",this.curImgItems[e].style.width=this.imgWidth+"px",this.curImgItems[e].style.height=this.imgHeight+"px",this.curImgItems[e].style.animationDuration=this.curImgItems[e].style.webkitAnimationDuration=this.show_speed+"s",this.fnAdjustImgItem(this.curImgItems[e],this.imgWidth,this.imgHeight),function(t,e,i){window.setTimeout(function(){t.style.display="block",t.className=i},50*e)}(this.curImgItems[e],e,this.effect_in[parseInt(this.effect_in.length*Math.random())])}},shikongzhilvSceneBase.prototype.leave=function(){for(var t=parseInt(Math.random()*this.effect_out.length),e=0;e<this.curImgItems.length;++e)this.curImgItems[e]&&(this.curImgItems[e].style.animationDuration=this.curImgItems[e].style.webkitAnimationDuration=this.hide_speed+"s",function(t,e,i,s){window.setTimeout(function(){t.className=s},150*i-150*e)}(this.curImgItems[e],e,this.curImgItems.length,this.effect_out[t][e])),this.curImgItems[e]=null},shikongzhilv_SCENE_EXTEND(shikongzhilvScene1,shikongzhilvSceneBase),shikongzhilv_SCENE_EXTEND(shikongzhilvScene2,shikongzhilvSceneBase),shikongzhilv_SCENE_EXTEND(shikongzhilvScene3,shikongzhilvSceneBase),shikongzhilv_SCENE_EXTEND(shikongzhilvScene4,shikongzhilvSceneBase),shikongzhilv_SCENE_EXTEND(shikongzhilvScene5,shikongzhilvSceneBase);